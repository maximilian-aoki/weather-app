(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var o=n.getElementsByTagName("script");if(o.length)for(var c=o.length-1;c>-1&&!t;)t=o[c--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t={};function n(e,n){t[e]=t[e]||[],t[e].push(n)}function o(e,n){t[e]&&t[e].forEach((e=>{e(n)}))}const c="f59714b9ced048d6b83171709230312";class r{static async getLocationData(e){const t=new URLSearchParams({key:c,days:2,q:e}),n=new Request("http://api.weatherapi.com/v1/forecast.json?"+t,{mode:"cors"});try{const e=await fetch(n),t=await e.json();return r.#e(t)}catch(e){return`Error in getLocationData: ${e}`}}static#e(e){const t={};return t.name=`${e.location.name}, ${e.location.country}`,t.isDay=Boolean(e.current.is_day),t.currentTimeIndex=Number(e.location.localtime.split(":")[0].split(" ")[1]),t.currentCondition=e.current.condition.text,t.currentConditionIcon=e.current.condition.icon,t.currentTempC=Math.round(e.current.temp_c),t.currentTempF=Math.round(e.current.temp_f),t.hours=r.#t(e,t.currentTimeIndex),t}static#t(e,t){return[...e.forecast.forecastday[0].hour.slice(t),...e.forecast.forecastday[1].hour.slice(0,t)].map((e=>{const t={};return t.timeIndex=Number(e.time.split(":")[0].split(" ")[1]),t.isDay=Boolean(e.is_day),t.condition=e.condition.text,t.conditionIcon=e.condition.icon,t.tempC=Math.round(e.temp_c),t.tempF=Math.round(e.temp_f),t}))}static async getLocationOptions(e){const t=new URLSearchParams({key:c,q:e}),n=new Request("http://api.weatherapi.com/v1/search.json?"+t,{mode:"cors"});try{const e=await fetch(n),t=await e.json();return r.#n(t)}catch(e){return`Error in getLocationOptions: ${e}`}}static#n(e){return[...new Set(e.map((e=>`${e.name}, ${e.country}`)))]}}const i=document.querySelector(".search-input"),a=document.querySelector(".search-results");class s{static async renderLocationNames(){if(i.value.length>=3){const e=await r.getLocationOptions(i.value);[...a.children].forEach((e=>a.removeChild(e))),e.forEach(s.#o)}else[...a.children].forEach((e=>a.removeChild(e)))}static#o(e){const t=document.createElement("li");t.classList.add("result"),t.innerText=e,a.appendChild(t)}static selectLocation(e){e.target.classList.contains("result")&&(o("addLocation",e.target.innerText),s.removeSearchResults())}static async removeSearchResults(){i.value="",s.renderLocationNames()}}i.addEventListener("input",s.renderLocationNames),a.addEventListener("click",s.selectLocation);const l=document.querySelector(".locations-list"),d=document.querySelector(".delete-buttons-list");class u{static renderLocationList(e){[...l.children].forEach((e=>l.removeChild(e))),[...d.children].forEach((e=>d.removeChild(e))),e.locations.forEach(u.#o)}static#o(e,t){const n=document.createElement("li");n.classList.add("location"),n.setAttribute("data-index",t),n.innerText=e.name;const o=document.createElement("li");o.classList.add("delete-button"),o.setAttribute("data-index",t),o.innerText="x",l.appendChild(n),d.appendChild(o)}static changeLocation(e){"location"===e.target.getAttribute("class")&&o("moveToLocation",Number(e.target.getAttribute("data-index")))}static showActiveLocation(e){for(const t of[...l.children])Number(t.getAttribute("data-index"))===e.currentLocIndex?t.classList.add("active"):t.classList.remove("active")}static deleteLocation(e){"delete-button"===e.target.getAttribute("class")&&o("removeLocation",Number(e.target.getAttribute("data-index")))}}l.addEventListener("click",u.changeLocation),d.addEventListener("click",u.deleteLocation),n("renderLocationList",u.renderLocationList),n("showActiveLocation",u.showActiveLocation);const m=document.querySelector(".weather-meta-container"),g=document.querySelector(".hourly-frame"),h=document.querySelector(".hourly-list"),L=document.querySelector(".temp-buttons");class p{static renderLocationWeather(e){if(e.currentLocIndex>=0){const t=e.locations[e.currentLocIndex],n="C"===e.currentDeg?t.currentTempC:t.currentTempF;m.innerHTML=`\n        <div class="meta-text grid">\n          <div class="text-name">\n            <h3>${t.name.split(",")[0]}</h3>\n            <h4>${t.name.split(",")[1].trim()}</h4>\n          </div>\n          <div class="text-condition">\n            <h3>Current Condition:</h3>\n            <p>${t.currentCondition}</p>\n          </div>\n        </div>\n        <div class="meta-data grid">\n          <div class="data-icon grid">\n            <img\n              src="https://${t.currentConditionIcon}"\n            />\n          </div>\n          <div class="data-temp grid">\n            <p>\n              <span class="data-temp-num">${n}</span>\n              <sup>o</sup>\n              <span class="data-temp-system">${e.currentDeg}</span>\n            </p>\n          </div>\n        </div>\n        `,[...h.children].forEach((e=>h.removeChild(e))),t.hours.forEach(((t,n)=>{p.addHourDisplay(t,n,e.currentDeg)})),g.scrollLeft=0}else m.innerHTML="",[...h.children].forEach((e=>h.removeChild(e)))}static addHourDisplay(e,t,n){const o=document.createElement("li"),c=p.#c(e.timeIndex,t),r=p.#r(e,n);o.innerHTML=`\n    <div class="hourly-temp grid">\n      <p>\n        <span class="hour-temp-num">${r}</span>\n        <sup>o</sup>\n        <span class="hour-temp-system">${n}</span>\n      </p>\n    </div>\n    <div class="hourly-condition grid">\n      <img\n        src="https://${e.conditionIcon}"\n      />\n    </div>\n    <div class="hourly-time grid">\n      <p>${c}</p>\n    </div>\n    `,h.appendChild(o)}static#c(e,t){return 0===t?"Now":0===e?"12 AM":e<12?`${e} AM`:12===e?"12 PM":e-12+" PM"}static#r(e,t){return"C"===t?e.tempC:e.tempF}static toggleDegrees(e){e.target.classList.contains("button")&&!e.target.classList.contains("active")&&([...L.children].forEach((e=>{e.classList.remove("active")})),e.target.classList.add("active"),o("toggleDegrees",e.target.innerText))}static renderDegrees(e){[...L.children].forEach((t=>{t.classList.remove("active"),t.innerText===e&&t.classList.add("active")}))}}L.addEventListener("click",p.toggleDegrees),n("renderLocationWeather",p.renderLocationWeather),n("renderDegrees",p.renderDegrees);class v{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"C";this.locations=e,this.currentLocIndex=t,this.currentDeg=n}addLocation(e){this.locations.push(e)}removeLocation(e){this.locations.splice(e,1)}refreshLocations(e){this.locations=e}getUserTime(){const e=new Date;this.userTime=e.toISOString().split(":")[0]}}const f=e.p+"49e7345b45a914725885.gif",y=document.querySelector(".loader");let w;if(y.src=f,localStorage.getItem("user")){console.log("getting user from localStorage with time");const e=JSON.parse(localStorage.getItem("user")),t=localStorage.getItem("time");w=new v(e.locations,e.currentLocIndex,e.currentDeg);const n=(new Date).toISOString().split(":")[0];if(console.log(`time now: ${n}\nlast user time: ${t}`),n!==t&&w.locations.length)try{D()}catch(e){console.log(`error on refresh: ${e}`),I()}else I(),console.log(w)}else console.log("creating new user"),w=new v,o("renderLocationList",w),o("renderDegrees",w.currentDeg),console.log(w);function x(){w.getUserTime(),localStorage.setItem("time",w.userTime),localStorage.setItem("user",JSON.stringify(w))}function I(){o("renderLocationList",w),o("showActiveLocation",w),o("renderLocationWeather",w),o("renderDegrees",w.currentDeg)}async function D(){console.log("starting refresh"),y.classList.add("active");const e=w.locations.map((e=>r.getLocationData(e.name)));w.locations=await Promise.all(e),y.classList.remove("active"),x(),I(),console.log("finished refresh"),console.log(w)}n("refreshLocations",D),n("addLocation",(async function(e){y.classList.add("active");const t=await r.getLocationData(e);y.classList.remove("active"),w.addLocation(t),w.currentLocIndex=w.locations.length-1,x(),I(),console.log("adding location"),console.log(w)})),n("removeLocation",(function(e){w.removeLocation(e),w.currentLocIndex=e<=w.currentLocIndex?w.currentLocIndex-=1:w.currentLocIndex,w.currentLocIndex<0&&Boolean(w.locations.length)&&(w.currentLocIndex=0),x(),I(),console.log("removing location"),console.log(w)})),n("moveToLocation",(function(e){e!==w.currentLocIndex&&(w.currentLocIndex=e,x(),o("showActiveLocation",w),o("renderLocationWeather",w),console.log(`switched location to index ${e}`),console.log(w))})),n("toggleDegrees",(function(e){w.currentDeg=e,x(),o("showActiveLocation",w),o("renderLocationWeather",w),console.log(`toggled degrees to ${e}`),console.log(w)}))})();
//# sourceMappingURL=app.bundle.js.map